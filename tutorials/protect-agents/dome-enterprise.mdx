---
title: "Introduction"
description: "This guide will walk you through deploying Vijil Dome on a Kubernetes cluster using Helm. Vijil Dome can be deployed on any Kubernetes-compatible platform, including Amazon EKS, Google GKE, Azure AKS, DigitalOcean Kubernetes, or any other Kubernetes distribution."
---

> **Alternative Deployment Option**: For DigitalOcean users, you can also deploy Vijil Dome directly through the [DigitalOcean Marketplace](https://marketplace.digitalocean.com/apps/vijil-dome), which provides a simplified one-click deployment experience.

![Vijil Dome Deployment Architecture](/images/dome-deployment.png)

*Figure: High-level architecture of Vijil Dome deployed on Kubernetes.*

## Prerequisites

Before deploying Vijil Dome, ensure you have the following prerequisites in place:

1. **Kubernetes Cluster**: A running Kubernetes cluster (version 1.24 or higher recommended)
   - For AWS: An EKS cluster configured and accessible via `kubectl`
   - For other platforms: A functional Kubernetes cluster with cluster-admin access

2. **Helm**: Helm 3.x installed and configured
   - Verify installation: `helm version`
   - Ensure Helm can access your Kubernetes cluster: `helm list`

3. **kubectl**: Kubernetes command-line tool configured to connect to your cluster
   - Verify connection: `kubectl cluster-info`

4. **OCI Registry Access**: Access to the Vijil Helm chart repository at `ghcr.io/vijilai/helm/vijil-dome`

## Installation

### Step 1: Prepare Configuration Files

Create two configuration files: `values.yaml` for general configuration and `secrets.yaml` for sensitive information.

#### values.yaml

Create a `values.yaml` file with your deployment configuration:

```yaml
# Cloud provider configuration
cloudProvider: aws  # Options: aws, digitalocean

# Replica count for the deployment
replicas: 1

# Secret management
createSecrets: false  # Set to false if secrets are managed externally

# AWS-specific configuration (if using AWS)
aws:
  nlb:
    subnets: "subnet-xxx,subnet-yyy"  # Replace with your subnet IDs
  # TLS configuration
  tls:
    enabled: true  # Enable TLS termination at NLB level
    certificateArn: "arn:aws:acm:region:account:certificate/cert-id"  # Your ACM certificate ARN
```

**Configuration Options:**
- `cloudProvider`: Specifies the cloud provider (`aws` or `digitalocean`)
- `replicas`: Number of pod replicas to deploy (default: 1)
- `createSecrets`: Set to `true` if you want Helm to create secrets from `secrets.yaml`, or `false` if managing secrets externally
- `aws.nlb.subnets`: Comma-separated list of subnet IDs for AWS Network Load Balancer (required for AWS deployments)
- `aws.tls.enabled`: Enable TLS termination at the load balancer level
- `aws.tls.certificateArn`: AWS Certificate Manager (ACM) certificate ARN for TLS

#### secrets.yaml

Create a `secrets.yaml` file with your API keys and sensitive configuration:

```yaml
# Enable secret creation when this file is used
createSecrets: true

secrets:
  app:
    # Required API keys
    DOME_API_KEY: "your-dome-api-key-that-you-create"
```

**Important Security Notes:**
- Never commit `secrets.yaml` to version control
- Store secrets securely using external secret management systems (e.g., AWS Secrets Manager, HashiCorp Vault) when possible
- If using external secret management, set `createSecrets: false` in `values.yaml` and manage secrets separately

### Step 2: Install Vijil Dome

Install Vijil Dome using Helm with your configuration files:

```bash
helm install vijil-dome oci://ghcr.io/vijilai/helm/vijil-dome \
  -f values/values.yaml \
  -f values/secrets/secrets.yaml
```

This command will:
- Create a namespace called `vijil-dome`
- Deploy the Vijil Dome application pods
- Create necessary services and load balancers
- Set up secrets (if `createSecrets: true`)

### Step 3: Verify Installation

Check that the deployment is running successfully:

```bash
# Check all deployed K8s objects
kubectl get all -n vijil-dome
```

For AWS deployments, check the ingress/load balancer:

```bash
# Get the load balancer address
kubectl get ingress -n vijil-dome

# Test the health endpoint
curl https://your-load-balancer-address/status
```

For DigitalOcean deployments:

```bash
# Get the external IP
kubectl get services -n vijil-dome

# Test using the external IP
curl http://EXTERNAL-IP/status
```

## Post-Installation Configuration

### AWS Deployments

1. **DNS Configuration**: If using TLS, configure your DNS to point to the Network Load Balancer address
2. **Route53 Setup**: Register the load balancer address in Route53 under your desired hosted zone

### Testing the Deployment

Once deployed, you can test the endpoints:

```bash
# Health check
curl "https://your-domain/status"

# Input detection endpoint
curl "https://your-domain/input_detection?api_key=YOUR_DOME_API_KEY&input_str=hello"

# Output detection endpoint
curl "https://your-domain/output_detection?api_key=YOUR_DOME_API_KEY&output_str=hello"
```

## Upgrading the Deployment

To upgrade to a newer version of Vijil Dome:

```bash
helm upgrade vijil-dome oci://ghcr.io/vijilai/helm/vijil-dome \
  -f values/values.yaml \
  -f values/secrets/secrets.yaml
```

## Uninstalling

To remove Vijil Dome from your cluster:

```bash
helm uninstall vijil-dome
```

This will remove all resources created by the Helm chart, including:
- Deployment and pods
- Services
- Secrets (if created by Helm)
- Namespace (if it was created by Helm)

## Resource Requirements

Vijil Dome has the following resource requirements per pod:

- **Memory**: 
  - Request: 4Gi
  - Limit: 8Gi
- **CPU**: 
  - Request: 2000m (2 cores)
  - Limit: 4000m (4 cores)
- **Ephemeral Storage**: 
  - Request: 10Gi
  - Limit: 20Gi

Ensure your Kubernetes cluster has sufficient resources to accommodate these requirements, especially if deploying multiple replicas.

## Troubleshooting

### Pods Not Starting

1. Check pod logs:
   ```bash
   kubectl logs -n vijil-dome <pod-name>
   ```

2. Check pod events:
   ```bash
   kubectl describe pod -n vijil-dome <pod-name>
   ```

### Secrets Not Working

1. Verify secrets are created:
   ```bash
   kubectl get secrets -n vijil-dome
   ```

2. If using external secrets, ensure they're properly configured and accessible to the pods

### Load Balancer Issues (AWS)

1. Verify subnet configuration in `values.yaml`
2. Check that the subnets are in the correct availability zones
3. Verify ACM certificate is in the same region as your EKS cluster

## Additional Resources

- **DigitalOcean Marketplace**: Deploy Vijil Dome with one click via the [DigitalOcean Marketplace](https://marketplace.digitalocean.com/apps/vijil-dome)
- For troubleshooting and support, contact Vijil support
