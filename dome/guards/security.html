<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="Moderation" href="moderation.html"><link rel="prev" title="List of Detection Methods" href="index.html">
        <link rel="prefetch" href="../../_static/vijil_wide.png" as="image">

    <link rel="shortcut icon" href="https://assets-global.website-files.com/656632658074164265ceea17/6570d66fa750acafb3a837ac_favicon.png"><!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Security - Vijil Docs</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Vijil Docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/vijil_wide.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Evaluating Agents</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../evaluate/examples/index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/agents.html">Add, Update, and Delete Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/api-keys.html">Managing API keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/evaluations.html">Evaluations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/owasp.html">OWASP LLM Top 10 Harness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/rag.html">RAG metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/detections.html">Working with Detections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/custom-harness.html">Custom Harnesses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/local-agent-evaluations.html">Evaluating Agents with Custom Endpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/reports.html">Evaluation Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/playground.html">Playground</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluate/examples/cicd.html">Integrating Vijil Evaluate into CI/CD</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../integrations/index.html">Integrations</a><input aria-label="Toggle navigation of Integrations" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/vertex.html">Google Vertex AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/digitalocean.html">DigitalOcean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/bedrock.html">AWS Bedrock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/custom.html">Custom Endpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/local.html">Local LLMs and Agents</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tests-library/index.html">Dimensions of Trust</a><input aria-label="Toggle navigation of Dimensions of Trust" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/privacy.html">Privacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/hallucination.html">Hallucination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/robustness.html">Robustness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/toxicity.html">Toxicity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/stereotype.html">Stereotype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/fairness.html">Fairness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tests-library/ethics.html">Ethics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../components/index.html">Trust Score Components</a><input aria-label="Toggle navigation of Trust Score Components" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../components/harnesses.html">Harnesses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../components/scenarios.html">Scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../components/probes.html">Probes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../components/detectors.html">Detectors</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../glossary/index.html">Glossary</a><input aria-label="Toggle navigation of Glossary" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../glossary/detectors.html">Detector Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glossary/probes.html">Probe Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Protecting Agents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuring Guardrails</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">List of Detection Methods</a><input aria-label="Toggle navigation of List of Detection Methods" checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="moderation.html">Moderation</a></li>
<li class="toctree-l2"><a class="reference internal" href="privacy.html">Privacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrity.html">Integrity</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/guardrails.html">Using Guardrails</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/domed-clients.html">Applying Dome to Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/langchain.html">Langchain Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/adk.html">Google ADK Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/custom-detectors.html">Custom Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/observability.html">Observability</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../integrations.html">Integrations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Enterprise Deployment of Evaluate</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise_deployment_eval/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise_deployment_eval/pre-requisites.html">Pre-requisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise_deployment_eval/deploying.html">Deploying Vijil Evaluate with Helm</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Enterprise Deployment of Dome</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise_deployment_dome/deployment.html">Deploying Vijil Dome</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/dome/guards/security.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="security">
<h1>Security<a class="headerlink" href="#security" title="Link to this heading">¶</a></h1>
<p>Security guards block against malicious prompts that attempt to cause the LLM to break its intended behaviour and guidelines. We currently support methods that aim to detect prompt injections, and jailbreak attacks. Security methods should typically be used in input guardrails.</p>
<p>The table below lists the security methods we currently support. The <code class="docutils literal notranslate"><span class="pre">ID</span></code> column should be used to use the detection method in a config.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>ID</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#vijil-prompt-injection-classifier-prompt-injection-mbert"><span class="xref myst">Vijil Prompt Injection MBert Classifier</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">prompt-injection-mbert</span></code></p></td>
<td><p>Vijil’s Finetuned Modern-BERT classifier for prompt injections and jailbreaks</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#prompt-injection-classifier-prompt-injection-deberta-v3-base"><span class="xref myst">DeBERTa Prompt Injection Classifier</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">prompt-injection-deberta-v3-base</span></code></p></td>
<td><p>Finetuned Deberta model to detect prompt injections and jailbreaks</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#meta-promptguard-security-promptguard"><span class="xref myst">Meta LLama PromptGuard</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">security-promptguard</span></code></p></td>
<td><p>Meta-Llama PromptGuard model to detect malicious jailbreaks and prompt injection attacks</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#security-prompt-engineering-security-llm"><span class="xref myst">Security Prompt Engineering</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">security-llm</span></code></p></td>
<td><p>Detect jailbreaks and prompt injection attacks via LLM prompt engineering</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#length-per-perplexity-heuristic-jb-length-per-perplexity"><span class="xref myst">Length-Per-Perplexity Heuristic</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jb-length-per-perplexity</span></code></p></td>
<td><p>Heuristic-driven jailbreak detection algorithm</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#prefix-suffix-perplexity-heuristic-jb-prefix-suffix-perplexity"><span class="xref myst">Prefix-Suffix-Perplexity Heuristic</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jb-prefix-suffix-perplexity</span></code></p></td>
<td><p>Another heuristic-driven jailbreak detection algorithm</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#security-embeddings-security-embeddings"><span class="xref myst">Security Embeddings</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">security-embeddings</span></code></p></td>
<td><p>Embeddings-based jailbreak and prompt injection detector</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#encoding-heuristics-encoding-heuristics"><span class="xref myst">Encoding Heuristics</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">encoding-heuristics</span></code></p></td>
<td><p>Heuristics-based algorithm to detect common jailbreak encoding techniques. Currently covers Base64, Hex, ROT13, ASCII Escapes, URL Encodings, Cyrillic Homoglyphs, Mixed Scripts, Excessive Whitespace and Zero-Width Character based encodings.</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<section id="vijil-prompt-injection-classifier-prompt-injection-mbert">
<h2>Vijil Prompt Injection Classifier (<code class="docutils literal notranslate"><span class="pre">prompt-injection-mbert</span></code>)<a class="headerlink" href="#vijil-prompt-injection-classifier-prompt-injection-mbert" title="Link to this heading">¶</a></h2>
<p>This is a <a class="reference external" href="https://huggingface.co/vijil/mbert-prompt-injection">finetuned modern-BERT model</a>, developed by Vijil that detects jailbreaks and prompt injection attacks. This model is enabled in Dome’s default configuration for security guardrails. It was selected as the default model as it is one of the best performing low-latency models for prompt injection detection based on both our testing and testing by third parties<a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>truncation</strong> (optional boolean): Determines if the model input should be truncated. Default value is true.</p></li>
<li><p><strong>max_length</strong> (optional int): Maximum length of input string. Default value is 512.</p></li>
</ul>
</section>
<section id="prompt-injection-classifier-prompt-injection-deberta-v3-base">
<h2>Prompt Injection Classifier (<code class="docutils literal notranslate"><span class="pre">prompt-injection-deberta-v3-base</span></code>)<a class="headerlink" href="#prompt-injection-classifier-prompt-injection-deberta-v3-base" title="Link to this heading">¶</a></h2>
<p>This is a <a class="reference external" href="https://huggingface.co/protectai/deberta-v3-base-prompt-injection">finetuned deberta-v3-base model</a>, intended to be a classifier for detecting jailbreaks and prompt injection attacks.</p>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>truncation</strong> (optional boolean): Determines if the model input should be truncated. Default value is true.</p></li>
<li><p><strong>max_length</strong> (optional int): Maximum length of input string. Default value is 512.</p></li>
</ul>
</section>
<section id="meta-promptguard-security-promptguard">
<h2>Meta PromptGuard (<code class="docutils literal notranslate"><span class="pre">security-promptguard</span></code>)<a class="headerlink" href="#meta-promptguard-security-promptguard" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://huggingface.co/meta-llama/Prompt-Guard-86M">Meta’s PromptGuard 86M model</a>. This is a multiligual DeBERTa model finetuned to detect malicious jailbreaks and prompt injections.</p>
<blockquote>
<div><p>PromptGuard is a gated model and requires access. Request access <a class="reference external" href="https://huggingface.co/meta-llama/Prompt-Guard-86M">here</a>. After being granted permission to use the model, you will need to set your HuggingFace token in your environment, or sign in via HF’s CLI to be able to download and use the model.</p>
</div></blockquote>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>score_threshold</strong> (optional float): The threshold for a prompt injection. Default value is 0.5. Values greater than or equal to this threshold will be flagged.</p></li>
<li><p><strong>truncation</strong> (optional boolean): Determines if the model input should be truncated. Default value is true.</p></li>
<li><p><strong>max_length</strong> (optional int): Maximum length of input string. Default value is 512.</p></li>
</ul>
</section>
<section id="security-prompt-engineering-security-llm">
<h2>Security Prompt Engineering (<code class="docutils literal notranslate"><span class="pre">security-llm</span></code>)<a class="headerlink" href="#security-prompt-engineering-security-llm" title="Link to this heading">¶</a></h2>
<p>A detector that uses custom prompt engineering to determine if the query string is a prompt-injection or jailbreak attempt.</p>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>hub_name</strong> (optional str): The hub that hosts the model you want to use. Currently supports OpenAI (<code class="docutils literal notranslate"><span class="pre">openai</span></code>) and Together (<code class="docutils literal notranslate"><span class="pre">together</span></code>). Default value is <code class="docutils literal notranslate"><span class="pre">openai</span></code>.</p></li>
<li><p><strong>model_name</strong> (optional str): The model that you want to use. Default value is <code class="docutils literal notranslate"><span class="pre">gpt-4o</span></code>. Please ensure that the model you wish to use is compatible with the hub you selected. When using models from Together, ensure the model starts with <code class="docutils literal notranslate"><span class="pre">together_ai</span></code> as per LiteLLM’s documentation.</p></li>
<li><p><strong>api_key</strong> (optional str): Specify the API key you want to use. By default, this is None, and the API key is pulled directly from the environment variables. The environment variables used are <code class="docutils literal notranslate"><span class="pre">OPENAI_API_KEY</span></code>, and <code class="docutils literal notranslate"><span class="pre">TOGETHERAI_API_KEY</span></code>.</p></li>
</ul>
</section>
<section id="length-per-perplexity-heuristic-jb-length-per-perplexity">
<h2>Length-Per-Perplexity Heuristic (<code class="docutils literal notranslate"><span class="pre">jb-length-per-perplexity</span></code>)<a class="headerlink" href="#length-per-perplexity-heuristic-jb-length-per-perplexity" title="Link to this heading">¶</a></h2>
<p>This method uses a heuristic based on perplexity outputs of GPT-2 and the length of a query string to determine if a prompt is a possible jailbreak attack. See <a class="reference external" href="https://docs.nvidia.com/nemo/guardrails/user_guides/guardrails-library.html#jailbreak-detection-heuristics">NeMo Guardrails</a> for additional details.</p>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>stride_length</strong> (optional int): Stride of the LLM. Default value is 512.</p></li>
<li><p><strong>threshold</strong> (optional float): the threshold of the heuristic. A string with a score higher than the threshold is classified as a jailbreak. Default value is 89.79.</p></li>
</ul>
</section>
<section id="prefix-suffix-perplexity-heuristic-jb-prefix-suffix-perplexity">
<h2>Prefix-Suffix-Perplexity Heuristic (<code class="docutils literal notranslate"><span class="pre">jb-prefix-suffix-perplexity</span></code>)<a class="headerlink" href="#prefix-suffix-perplexity-heuristic-jb-prefix-suffix-perplexity" title="Link to this heading">¶</a></h2>
<p>Similar to the previous method, this method uses a hueristic based on the perplexity of the first and last 20 words of a query. See <a class="reference external" href="https://docs.nvidia.com/nemo/guardrails/user_guides/guardrails-library.html#jailbreak-detection-heuristics">NeMo Guardrails</a> for additional details.</p>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>stride_length</strong> (optional int): Stride of the LLM. Default value is 512.</p></li>
<li><p><strong>prefix_threshold</strong> (optional float): The threshold for prefix perplexity. Any query string with a prefix threshold higher than this is flagged as a jailbreak attempt. Default value is 1845.65.</p></li>
<li><p><strong>suffix_threshold</strong> (optional float): The threshold for suffix perplexity. Any query string with a suffix threshold higher than this is flagged as a jailbreak attempt. Default value is 1845.65.</p></li>
<li><p><strong>prefix_length</strong> (optional int): The number of words to consider in the prefix. If this is larger than the number of words in the query string, the max length of the query string is used. Default value is 20.</p></li>
<li><p><strong>suffix_length</strong> (optional int): The number of words to consider in the suffix. If this is larger than the number of words in the query string, the max length of the query string is used. Default value is 20.</p></li>
</ul>
</section>
<section id="security-embeddings-security-embeddings">
<h2>Security Embeddings (<code class="docutils literal notranslate"><span class="pre">security-embeddings</span></code>)<a class="headerlink" href="#security-embeddings-security-embeddings" title="Link to this heading">¶</a></h2>
<p>Creates an embeddings index using the garak-in-the-wild-jailbreaks dataset.</p>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>engine</strong> (optional str): The engine to perform the embeddings. We currently support <code class="docutils literal notranslate"><span class="pre">SentenceTransformer</span></code> and <code class="docutils literal notranslate"><span class="pre">FastEmbed</span></code>. Default value is <code class="docutils literal notranslate"><span class="pre">SentenceTransformer</span></code>.</p></li>
<li><p><strong>model</strong> (optional str): The embedding model to use. Default value is <code class="docutils literal notranslate"><span class="pre">all-MiniLM-L6-v2</span></code>.</p></li>
<li><p><strong>threshold</strong> (optional float. The default similarity threshold. If the similarity between a query and its nearest neighbour is greater than or equal to this value, the query is flagged. Default value is 0.8.</p></li>
<li><p><strong>in_mem</strong> (optional boolean): Keep the index in memory via a Pandas dataframe (if true) or via Annoy (if False). (Note: Annoy appears to have some instability on Windows environments, and does not work with agents deployed via Google Cloud Run). Default value is true.</p></li>
</ul>
</section>
<section id="encoding-heuristics-encoding-heuristics">
<h2>Encoding Heuristics (<code class="docutils literal notranslate"><span class="pre">encoding-heuristics</span></code>)<a class="headerlink" href="#encoding-heuristics-encoding-heuristics" title="Link to this heading">¶</a></h2>
<p>A series of heuristic-based algorithms to detect the presence of Base64, Hex, URL and ROT13 encoded prompts, and prompts that have been manipulated with cyrillic encodings, mixed scripts, zero width characters and whitespace injections. These techniques are common ways of obfuscating prompt injection attacks, and in most scenarios, would never be part of a normal usage pattern.</p>
<p>This method is enabled in Dome’s default configuration.</p>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><strong>threshold_map</strong> (optional Dict[str, float]): A dictionary with a threshold value for each encoding heuristic. Inputs are flagged if the heuristic score for the prompt crosses the threshold. The default thresholds are as follows:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;base64&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="s2">&quot;rot13&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="s2">&quot;ascii_escape&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="s2">&quot;hex_encoding&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
    <span class="s2">&quot;url_encoding&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
    <span class="s2">&quot;cyrillic_homoglyphs&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="s2">&quot;mixed_scripts&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="s2">&quot;zero_width&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s2">&quot;excessive_whitespace&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://arxiv.org/abs/2504.11168">Bypassing Prompt Injection and Jailbreak Detection in LLM Guardrails
</a></p>
</aside>
</aside>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="moderation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Moderation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">List of Detection Methods</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Vijil Inc
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Security</a><ul>
<li><a class="reference internal" href="#vijil-prompt-injection-classifier-prompt-injection-mbert">Vijil Prompt Injection Classifier (<code class="docutils literal notranslate"><span class="pre">prompt-injection-mbert</span></code>)</a></li>
<li><a class="reference internal" href="#prompt-injection-classifier-prompt-injection-deberta-v3-base">Prompt Injection Classifier (<code class="docutils literal notranslate"><span class="pre">prompt-injection-deberta-v3-base</span></code>)</a></li>
<li><a class="reference internal" href="#meta-promptguard-security-promptguard">Meta PromptGuard (<code class="docutils literal notranslate"><span class="pre">security-promptguard</span></code>)</a></li>
<li><a class="reference internal" href="#security-prompt-engineering-security-llm">Security Prompt Engineering (<code class="docutils literal notranslate"><span class="pre">security-llm</span></code>)</a></li>
<li><a class="reference internal" href="#length-per-perplexity-heuristic-jb-length-per-perplexity">Length-Per-Perplexity Heuristic (<code class="docutils literal notranslate"><span class="pre">jb-length-per-perplexity</span></code>)</a></li>
<li><a class="reference internal" href="#prefix-suffix-perplexity-heuristic-jb-prefix-suffix-perplexity">Prefix-Suffix-Perplexity Heuristic (<code class="docutils literal notranslate"><span class="pre">jb-prefix-suffix-perplexity</span></code>)</a></li>
<li><a class="reference internal" href="#security-embeddings-security-embeddings">Security Embeddings (<code class="docutils literal notranslate"><span class="pre">security-embeddings</span></code>)</a></li>
<li><a class="reference internal" href="#encoding-heuristics-encoding-heuristics">Encoding Heuristics (<code class="docutils literal notranslate"><span class="pre">encoding-heuristics</span></code>)</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    </body>
</html>