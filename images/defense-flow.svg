<svg viewBox="0 0 600 340" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <filter id="pencil" x="-20%" y="-20%" width="140%" height="140%">
      <feTurbulence type="fractalNoise" baseFrequency="0.04" numOctaves="5" result="noise"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="1.5" xChannelSelector="R" yChannelSelector="G"/>
    </filter>
  </defs>

  <style>
    .label-text {
      font-family: 'Segoe UI', system-ui, sans-serif;
      font-size: 13px;
      font-weight: 500;
    }
    .small-text {
      font-family: 'Segoe UI', system-ui, sans-serif;
      font-size: 10px;
      fill: #666;
    }
  </style>

  <!-- Entry arrow into Input Guardrail -->
  <line x1="120" y1="10" x2="120" y2="41" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="120,45 112,33 128,33" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Left column: Descending (Input Defense) -->

  <!-- Input Guardrail - RED background (untrusted) -->
  <rect x="60" y="45" width="120" height="36" rx="18"
        fill="#DE1616" stroke="#DE1616" stroke-width="2" filter="url(#pencil)"/>
  <text x="120" y="68" text-anchor="middle" class="label-text" fill="white">Guardrail</text>

  <!-- Arrow down to Guard -->
  <line x1="120" y1="85" x2="120" y2="106" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="120,110 112,98 128,98" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Guard -->
  <rect x="60" y="110" width="120" height="36" rx="18"
        fill="white" stroke="#DE1616" stroke-width="2" filter="url(#pencil)"/>
  <text x="120" y="133" text-anchor="middle" class="label-text" fill="#DE1616">Guard</text>

  <!-- Arrow down to Detector -->
  <line x1="120" y1="150" x2="120" y2="171" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="120,175 112,163 128,163" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Detector -->
  <rect x="60" y="175" width="120" height="36" rx="18"
        fill="white" stroke="#DE1616" stroke-width="2" filter="url(#pencil)"/>
  <text x="120" y="198" text-anchor="middle" class="label-text" fill="#DE1616">Detector</text>

  <!-- Arrow down to Action -->
  <line x1="120" y1="215" x2="120" y2="236" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="120,240 112,228 128,228" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Action -->
  <rect x="60" y="240" width="120" height="36" rx="18"
        fill="white" stroke="#DE1616" stroke-width="2" filter="url(#pencil)"/>
  <text x="120" y="263" text-anchor="middle" class="label-text" fill="#DE1616">Action</text>

  <!-- Bottom: Horizontal (Agent Interaction) -->

  <!-- Arrow from Action to Agent -->
  <line x1="184" y1="258" x2="264" y2="258" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="270,258 258,250 258,266" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Agent circle -->
  <circle cx="300" cy="258" r="24" fill="#DE1616" stroke="#0247A9" stroke-width="4" filter="url(#pencil)"/>
  <text x="300" y="263" text-anchor="middle" class="label-text" fill="white" font-size="11">Agent</text>

  <!-- Arrow from Agent to Action -->
  <line x1="328" y1="258" x2="408" y2="258" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="414,258 402,250 402,266" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Right column: Ascending (Output Defense) -->

  <!-- Action (output) -->
  <rect x="420" y="240" width="120" height="36" rx="18"
        fill="white" stroke="#DE1616" stroke-width="2" filter="url(#pencil)"/>
  <text x="480" y="263" text-anchor="middle" class="label-text" fill="#DE1616">Action</text>

  <!-- Arrow up to Detector -->
  <line x1="480" y1="236" x2="480" y2="215" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="480,211 472,223 488,223" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Detector (output) -->
  <rect x="420" y="175" width="120" height="36" rx="18"
        fill="white" stroke="#DE1616" stroke-width="2" filter="url(#pencil)"/>
  <text x="480" y="198" text-anchor="middle" class="label-text" fill="#DE1616">Detector</text>

  <!-- Arrow up to Guard -->
  <line x1="480" y1="171" x2="480" y2="150" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="480,146 472,158 488,158" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Guard (output) -->
  <rect x="420" y="110" width="120" height="36" rx="18"
        fill="white" stroke="#DE1616" stroke-width="2" filter="url(#pencil)"/>
  <text x="480" y="133" text-anchor="middle" class="label-text" fill="#DE1616">Guard</text>

  <!-- Arrow up to Guardrail -->
  <line x1="480" y1="106" x2="480" y2="85" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="480,81 472,93 488,93" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Output Guardrail - BLUE background (trusted) -->
  <rect x="420" y="45" width="120" height="36" rx="18"
        fill="#0247A9" stroke="#0247A9" stroke-width="2" filter="url(#pencil)"/>
  <text x="480" y="68" text-anchor="middle" class="label-text" fill="white">Guardrail</text>

  <!-- Exit arrow from Output Guardrail -->
  <line x1="480" y1="41" x2="480" y2="20" stroke="#DE1616" stroke-width="4" filter="url(#pencil)"/>
  <polygon points="480,10 472,22 488,22" fill="#DE1616" filter="url(#pencil)"/>

  <!-- Column labels -->
  <text x="120" y="305" text-anchor="middle" class="small-text">Input Defense</text>
  <text x="300" y="305" text-anchor="middle" class="small-text">Execution</text>
  <text x="480" y="305" text-anchor="middle" class="small-text">Output Defense</text>

</svg>